import{c as k,j as e,a as K,r as b,d as T,B as C,s as $,u as H}from"./index-Cfyb-cTT.js";import{L as U}from"./Layout-Bu6kW370.js";import{C as V,c as F}from"./index-lOgDGn8a.js";import{g as z,a as L}from"./dateUtils-GKxu_fIk.js";import{s as G}from"./assetService-DnP0953v.js";import{s as O,t as q}from"./assetNotificationService-Rh4JThwE.js";import{D as X}from"./DateInput-DswrObUo.js";import{S as M,a as E,b as w,c as I,d as y}from"./select-CdJOJDrA.js";import{L as A}from"./label-KRVLd3Sf.js";import{I as B,A as Q,b as Y,a as Z}from"./input-DI_PInR2.js";import{D as W,a as J,b as ee,c as se,d as te,e as ne,U as ae,P as re}from"./dialog-rBNaRCCh.js";import{C as _}from"./camera-CDeARvGO.js";import{u as oe}from"./useCurrentUser-DoC6E23S.js";import"./format-CaiECi-v.js";import"./addDays-ggkpGDyJ.js";import"./emailUtils-C-rUDXQT.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=k("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=k("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=k("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=k("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=k("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),ge=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Th√¥ng b√°o M∆∞·ª£n/Xu·∫•t"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Khung gi·ªù ",e.jsx("span",{className:"font-semibold",children:"7:45-8:05"})," v√† ",e.jsx("span",{className:"font-semibold",children:"12:45-13:05"})," h√£y nh·∫Øn Zalo v√¨ ƒë√£ ch·ªët DS"]})]}),e.jsx(V,{id:"instruction-section",className:"border-green-200 bg-gradient-to-r from-slate-50 to-green-50",children:e.jsx(F,{className:"p-4",children:e.jsxs("p",{children:["T·ª´ ",e.jsx("strong",{children:"Ph·∫£i"})," sang ",e.jsx("strong",{children:"Tr√°i"}),": 2 k√Ω t·ª± t·ª´ th·ª© ",e.jsx("strong",{children:"9"})," v√† ",e.jsx("strong",{children:"10"})," l√† ",e.jsx("strong",{children:"NƒÉm TS"}),": 24, 4 k√Ω t·ª± cu·ªëi l√† ",e.jsx("strong",{children:"M√£ TS"}),": 259 - vd: 042410",e.jsx("strong",{children:"24"}),"7020",e.jsx("strong",{children:"0259"})," ‚Üí 259.24"]})})})]}),R=t=>{for(const n of t){const s=n.trim();if(!s)return{isValid:!1,error:"M√£ t√†i s·∫£n kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng"};if(!s.includes("."))return{isValid:!1,error:`M√£ "${s}" kh√¥ng h·ª£p l·ªá. Ph·∫£i c√≥ d·∫•u ch·∫•m.`};const a=s.split(".");if(a.length!==2||!a[0]||!a[1])return{isValid:!1,error:`M√£ "${s}" kh√¥ng h·ª£p l·ªá. Ph·∫£i c√≥ d·∫°ng [M√£ TS].[NƒÉm TS].`};const[o,r]=a;if(!/^\d+$/.test(o)||!/^\d+$/.test(r))return{isValid:!1,error:`M√£ "${s}" ph·∫£i l√† s·ªë.`};if(o.length>4)return{isValid:!1,error:`M√£ TS trong "${s}" kh√¥ng ƒë∆∞·ª£c d√†i h∆°n 4 k√Ω t·ª±.`};if(r.length!==2)return{isValid:!1,error:`NƒÉm TS trong "${s}" ph·∫£i c√≥ ƒë√∫ng 2 k√Ω t·ª±.`};const i=parseInt(r,10);if(i<21||i>99)return{isValid:!1,error:`NƒÉm TS trong "${s}" ph·∫£i t·ª´ 21 ƒë·∫øn 99.`}}return{isValid:!0,error:null}},me=()=>{const{user:t}=K(),[n,s]=b.useState({transaction_date:"",parts_day:"",room:"",note:"",transaction_type:""}),[a,o]=b.useState([""]),[r,i]=b.useState(),l=()=>{const{defaultDate:h,disabledBefore:f}=z();i(f);const d=L(),u=d.getHours(),v=d.getMinutes();let N="S√°ng";u>=8&&(u<12||u===12&&v<=45)?N="Chi·ªÅu":N="S√°ng",s({transaction_date:h,parts_day:N,room:"",note:"",transaction_type:""})};b.useEffect(()=>{t&&l()},[t]);const m=h=>{s(f=>{const d={...f,room:h,note:""},v=L().getHours();return(v>=13||v<8)&&(["QLN","DVKH"].includes(h)?d.parts_day="S√°ng":["CMT8","NS","ƒêS","LƒêH"].includes(h)&&(d.parts_day="Chi·ªÅu")),["CMT8","NS","ƒêS","LƒêH"].includes(h)&&(d.note="Ship PGD"),d})},p=(h,f)=>{const d=f.replace(/[^0-9.]/g,"");if((d.match(/\./g)||[]).length>1)return;const u=d.split(".");let v=d;if(u.length>1){const S=u[0].slice(0,4),D=u[1].slice(0,2);v=`${S}.${D}`}else v=u[0].slice(0,4);const N=[...a];N[h]=v,o(N)},x=()=>{o([...a,""])},c=h=>{if(a.length>1){const f=a.filter((d,u)=>u!==h);o(f)}},j=b.useMemo(()=>n.room&&n.transaction_type&&n.transaction_date&&n.parts_day&&a.every(h=>h.trim()&&R([h]).isValid),[n,a]);return{formData:n,setFormData:s,multipleAssets:a,setMultipleAssets:o,isFormValid:j,handleRoomChange:m,handleAssetChange:p,addAssetField:x,removeAssetField:c,clearForm:()=>{o([""]),t&&l()},disabledBeforeDate:r}},ue=(t,n)=>n?{isValid:!1,error:"Kh√¥ng th·ªÉ g·ª≠i trong khung gi·ªù 7:45-8:05 v√† 12:45-13:05"}:R(t),pe=async(t,n,s)=>{console.log("=== ASSET ENTRY SUBMIT START ==="),console.log("Current user:",s);const a=n.map(i=>{const[l,m]=i.split(".");return{staff_code:s,transaction_date:t.transaction_date,parts_day:t.parts_day,room:t.room,transaction_type:t.transaction_type,asset_year:parseInt(m),asset_code:parseInt(l),note:t.note||null}});console.log("Submitting transactions:",a);const o=await G(a);console.log("Successfully saved to database:",o),console.log("=== SENDING EMAIL NOTIFICATION ===");const r=await O(s,o);return console.log("Email notification result:",r),console.log("=== ASSET ENTRY SUBMIT END ==="),{savedTransactions:o,emailResult:r}},xe=async t=>{if(console.log("=== TEST EMAIL FUNCTION START ==="),console.log("Username:",t),!t)throw new Error("Kh√¥ng t√¨m th·∫•y th√¥ng tin ng∆∞·ªùi d√πng");console.log("üìß Calling testEmailFunction with username:",t);const n=await q(t);return console.log("üìß Test email result:",n),console.log("=== TEST EMAIL FUNCTION END ==="),n},fe=()=>{const[t,n]=b.useState(!1),s=(r,i,l)=>{l==="destructive"?T.error(r,{description:i}):T.success(r,{description:i})};return{isLoading:t,handleSubmit:async(r,i,l,m,p)=>{if(console.log("=== ASSET SUBMISSION DEBUG START ==="),console.log("isRestrictedTime:",l),console.log("formData:",r),console.log("multipleAssets:",i),console.log("username for submission:",p),l){console.log("‚ùå Submission blocked - restricted time"),s("Kh√¥ng th·ªÉ g·ª≠i","Kh√¥ng th·ªÉ g·ª≠i trong khung gi·ªù 7:45-8:05 v√† 12:45-13:05","destructive");return}const x=ue(i,l);if(console.log("Validation result:",x),!x.isValid){console.log("‚ùå Validation failed:",x.error),s("L·ªói x√°c th·ª±c",x.error||"","destructive");return}if(!p){s("L·ªói","Kh√¥ng t√¨m th·∫•y th√¥ng tin ng∆∞·ªùi d√πng ƒë·ªÉ g·ª≠i th√¥ng b√°o. Vui l√≤ng ƒëƒÉng nh·∫≠p l·∫°i.","destructive"),n(!1);return}n(!0);try{const{savedTransactions:c,emailResult:j}=await pe(r,i,p);j.success?(console.log("‚úÖ Email sent successfully"),s("Th√†nh c√¥ng!",`ƒê√£ g·ª≠i th√†nh c√¥ng ${i.length} th√¥ng b√°o t√†i s·∫£n v√† email x√°c nh·∫≠n`)):(console.log("‚ö†Ô∏è Email failed but database save successful"),s("L∆∞u th√†nh c√¥ng nh∆∞ng g·ª≠i email th·∫•t b·∫°i",`ƒê√£ l∆∞u ${i.length} th√¥ng b√°o t√†i s·∫£n nh∆∞ng kh√¥ng g·ª≠i ƒë∆∞·ª£c email: ${j.error}`,"destructive")),m()}catch(c){console.error("‚ùå Error submitting form:",c);const j=c instanceof Error?c.message:"C√≥ l·ªói x·∫£y ra khi g·ª≠i th√¥ng b√°o";c instanceof Error&&c.message.includes("email")?s("L∆∞u th√†nh c√¥ng nh∆∞ng g·ª≠i email th·∫•t b·∫°i",`ƒê√£ l∆∞u ${i.length} th√¥ng b√°o t√†i s·∫£n nh∆∞ng c√≥ l·ªói khi g·ª≠i email`,"destructive"):s("L·ªói g·ª≠i th√¥ng b√°o",j,"destructive")}finally{n(!1),console.log("=== ASSET SUBMISSION DEBUG END ===")}},handleTestEmail:async r=>{if(!r){s("L·ªói","Kh√¥ng t√¨m th·∫•y th√¥ng tin ng∆∞·ªùi d√πng","destructive");return}n(!0);try{const i=await xe(r);i.success?(console.log("‚úÖ Email test th√†nh c√¥ng, hi·ªÉn th·ªã toast th√†nh c√¥ng"),s("Email test th√†nh c√¥ng!","Ki·ªÉm tra h·ªôp th∆∞ c·ªßa b·∫°n")):(console.log("‚ùå Email test th·∫•t b·∫°i, hi·ªÉn th·ªã toast l·ªói"),s("Email test th·∫•t b·∫°i",i.error||"L·ªói kh√¥ng x√°c ƒë·ªãnh","destructive"))}catch(i){console.error("‚ùå Ngo·∫°i l·ªá trong handleTestEmail:",i);const l=i instanceof Error?i.message:"C√≥ l·ªói x·∫£y ra khi test email";s("L·ªói test email",l,"destructive")}finally{n(!1)}}}},ye=({formData:t,setFormData:n,disabledBeforeDate:s})=>{const a=(o,r)=>{n(i=>({...i,[o]:r}))};return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[" ",e.jsx(A,{children:"Bu·ªïi v√† ng√†y l·∫•y TS"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(M,{value:t.parts_day,onValueChange:o=>a("parts_day",o),children:[e.jsx(E,{children:e.jsx(w,{placeholder:"Ch·ªçn bu·ªïi"})}),e.jsxs(I,{children:[e.jsx(y,{value:"S√°ng",children:"S√°ng"}),e.jsx(y,{value:"Chi·ªÅu",children:"Chi·ªÅu"})]})]}),e.jsx(X,{value:t.transaction_date,onChange:o=>a("transaction_date",o),disabledBefore:s})]})]})})},je=({formData:t,onRoomChange:n,onFormDataChange:s})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs(A,{className:"flex items-center text-base font-semibold",children:[e.jsx(le,{className:"w-5 h-5 mr-2 text-green-600"}),"T√†i s·∫£n c·ªßa ph√≤ng"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(M,{value:t.room,onValueChange:n,children:[e.jsx(E,{children:e.jsx(w,{placeholder:"Ch·ªçn ph√≤ng"})}),e.jsxs(I,{children:[e.jsx(y,{value:"QLN",children:"QLN"}),e.jsx(y,{value:"CMT8",children:"CMT8"}),e.jsx(y,{value:"NS",children:"NS"}),e.jsx(y,{value:"ƒêS",children:"ƒêS"}),e.jsx(y,{value:"LƒêH",children:"LƒêH"}),e.jsx(y,{value:"DVKH",children:"DVKH"})]})]}),t.room==="QLN"&&e.jsx(B,{placeholder:"Ghi ch√∫ t√πy √Ω",value:t.note||"",onChange:a=>s("note",a.target.value)}),["CMT8","NS","ƒêS","LƒêH"].includes(t.room)&&e.jsxs(M,{value:t.note||"",onValueChange:a=>s("note",a),children:[e.jsx(E,{children:e.jsx(w,{placeholder:"Ch·ªçn lo·∫°i giao nh·∫≠n"})}),e.jsxs(I,{children:[e.jsx(y,{value:"Ship PGD",children:"Ship PGD"}),e.jsx(y,{value:"L·∫•y ·ªü CN",children:"L·∫•y ·ªü CN"})]})]})]})]}),ve=({isProcessingImage:t,isDialogOpen:n,setIsDialogOpen:s,onCameraClick:a,onUploadClick:o})=>e.jsxs(W,{open:n,onOpenChange:s,children:[e.jsx(J,{asChild:!0,children:e.jsxs(C,{variant:"ghost",size:"sm",className:"text-green-600",children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),"AI"]})}),e.jsxs(ee,{children:[e.jsxs(se,{children:[e.jsx(te,{children:"Tr√≠ch xu·∫•t m√£ t√†i s·∫£n t·ª´ h√¨nh ·∫£nh"}),e.jsx(ne,{children:"Ch·ªçn c√°ch b·∫°n mu·ªën t·∫£i ·∫£nh l√™n ƒë·ªÉ tr√≠ch xu·∫•t m√£ t√†i s·∫£n."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(C,{className:"w-full",onClick:()=>{var r;return(r=document.getElementById("file-upload"))==null?void 0:r.click()},disabled:t,children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),t?"ƒêang x·ª≠ l√Ω...":"Upload t·ª´ thi·∫øt b·ªã"]}),e.jsx("input",{id:"file-upload",type:"file",accept:"image/*",className:"hidden",onChange:r=>r.target.files&&o(r.target.files)}),e.jsxs(C,{variant:"outline",className:"w-full",onClick:a,disabled:t,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),t?"ƒêang x·ª≠ l√Ω...":"Ch·ª•p ·∫£nh"]})]})]})]}),Se=async t=>{try{console.log("Starting image analysis with Gemini for file:",t.name);const n=await be(t);console.log("Image converted to base64, size:",n.length);const s=await $.functions.invoke("analyze-asset-image",{body:{image:n,mimeType:t.type}});if(console.log("Supabase function response:",s),s.error)throw console.error("Gemini API error:",s.error),new Error("L·ªói khi ph√¢n t√≠ch h√¨nh ·∫£nh: "+s.error.message);if(!s.data)throw new Error("Kh√¥ng nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu t·ª´ API");return console.log("Analysis result:",s.data),s.data}catch(n){throw console.error("Error analyzing image:",n),new Error("Kh√¥ng th·ªÉ ph√¢n t√≠ch h√¨nh ·∫£nh. Vui l√≤ng th·ª≠ l·∫°i.")}},be=t=>new Promise((n,s)=>{const a=new FileReader;a.readAsDataURL(t),a.onload=()=>{const r=a.result.split(",")[1];n(r)},a.onerror=o=>s(o)}),Te=({onAssetCodesDetected:t,onRoomDetected:n})=>{const[s,a]=b.useState(!1),[o,r]=b.useState(!1);return{isProcessingImage:s,isDialogOpen:o,setIsDialogOpen:r,processImages:async l=>{if(!l||l.length===0){T.error("Kh√¥ng c√≥ t·ªáp n√†o ƒë∆∞·ª£c ch·ªçn.");return}a(!0),r(!1);const m=l[0],p=5,x=p*1024*1024;if(m.size>x){T.error(`K√≠ch th∆∞·ªõc t·ªáp qu√° l·ªõn. Vui l√≤ng ch·ªçn ·∫£nh nh·ªè h∆°n ${p}MB.`),a(!1);return}try{const c=await Se(m);return console.log("Image processing result:",c),c.assetCodes&&c.assetCodes.length>0&&t(c.assetCodes),c.detectedRoom&&n(c.detectedRoom),c}catch(c){console.error("Error processing image:",c);const j=c instanceof Error?c.message:"C√≥ l·ªói x·∫£y ra khi x·ª≠ l√Ω h√¨nh ·∫£nh.";T.error("L·ªói x·ª≠ l√Ω h√¨nh ·∫£nh",{description:j});return}finally{a(!1)}}}},Ce=({assets:t,onAssetChange:n,onAddAsset:s,onRemoveAsset:a,onAssetCodesDetected:o,onRoomDetected:r})=>{const{isProcessingImage:i,isDialogOpen:l,setIsDialogOpen:m,processImages:p}=Te({onAssetCodesDetected:o,onRoomDetected:r}),x=g=>{g.assetCodes.length>0?T.success("Ph√°t hi·ªán m√£ t√†i s·∫£n th√†nh c√¥ng!",{description:`ƒê√£ t√¨m th·∫•y ${g.assetCodes.length} m√£ t√†i s·∫£n`}):T.info("Kh√¥ng t√¨m th·∫•y m√£ t√†i s·∫£n n√†o trong h√¨nh ·∫£nh."),g.detectedRoom?T.success("Ph√°t hi·ªán ph√≤ng th√†nh c√¥ng!",{description:`ƒê√£ t√¨m th·∫•y ph√≤ng: ${g.detectedRoom}`}):T.info("Kh√¥ng t√¨m th·∫•y th√¥ng tin ph√≤ng trong h√¨nh ·∫£nh.")},c=async g=>{const h=await p(g);h&&x(h)},j=async()=>{const g=document.createElement("input");g.type="file",g.accept="image/*",g.capture="environment",g.onchange=async h=>{const f=h.target,d=await p(f.files);d&&x(d)},g.click()};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{className:"text-base font-semibold",children:"Nh·∫≠p [M√£ TS].[NƒÉm TS]: C√≥ d·∫•u CH·∫§M gi·ªØa m√£ TS v√† nƒÉm TS"}),e.jsx(ve,{isProcessingImage:i,isDialogOpen:l,setIsDialogOpen:m,onCameraClick:j,onUploadClick:c})]}),e.jsx("div",{className:"space-y-3",children:t.map((g,h)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{value:g,onChange:f=>n(h,f.target.value),placeholder:"259.24",className:"text-center font-mono"}),e.jsx(C,{type:"button",variant:"outline",size:"icon",onClick:s,className:"text-green-600",children:e.jsx(re,{className:"w-4 h-4"})}),t.length>1&&e.jsx(C,{type:"button",variant:"outline",size:"icon",onClick:()=>a(h),className:"text-red-600",children:e.jsx(ce,{className:"w-4 h-4"})})]},h))})]})},Ne=({isRestrictedTime:t,isFormValid:n,isLoading:s,user:a,onClear:o,onSubmit:r,onTestEmail:i})=>{const l=H();return e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("div",{className:"flex space-x-4",children:t?e.jsx("div",{className:"text-orange-600 font-medium",children:"Kh√¥ng th·ªÉ l∆∞u d·ªØ li·ªáu trong gi·ªù ngh·ªâ"}):e.jsxs(e.Fragment,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:o,children:"Clear"}),e.jsx(C,{type:"submit",className:"bg-green-600 hover:bg-green-700",disabled:!n||s,onClick:r,children:s?"ƒêang g·ª≠i...":"G·ª≠i th√¥ng b√°o"})]})}),e.jsxs("div",{className:"flex space-x-4",children:[(a==null?void 0:a.role)==="admin"&&e.jsxs(C,{type:"button",variant:"outline",onClick:i,disabled:!(a!=null&&a.username)||s,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),s?"ƒêang test...":"Test Email"]}),e.jsxs(C,{type:"button",variant:"outline",onClick:()=>l("/error-report"),className:"text-red-600 border-red-200 hover:bg-red-50",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"B√°o l·ªói v√† g·ª≠i h√¨nh l·ªói"]})]})]})},ke=({formData:t,onFormDataChange:n})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Lo·∫°i t√°c nghi·ªáp Xu·∫•t/M∆∞·ª£n/Thay b√¨a"}),e.jsxs(M,{value:t.transaction_type,onValueChange:s=>n("transaction_type",s),children:[e.jsx(E,{children:e.jsx(w,{placeholder:"Ch·ªçn lo·∫°i t√°c nghi·ªáp"})}),e.jsxs(I,{children:[e.jsx(y,{value:"Xu·∫•t kho",children:"Xu·∫•t kho"}),e.jsx(y,{value:"M∆∞·ª£n TS",children:"M∆∞·ª£n TS"}),e.jsx(y,{value:"Thay b√¨a",children:"Thay b√¨a"})]})]})]}),Me=({isRestrictedTime:t})=>{const{currentUser:n}=oe(),{formData:s,setFormData:a,multipleAssets:o,setMultipleAssets:r,handleRoomChange:i,handleAssetChange:l,addAssetField:m,removeAssetField:p,isFormValid:x,clearForm:c,disabledBeforeDate:j}=me(),{handleSubmit:g,isLoading:h,handleTestEmail:f}=fe(),d=S=>{S.preventDefault(),g(s,o,t,c,(n==null?void 0:n.username)||"")},u=(S,D)=>{a(P=>({...P,[S]:D}))},v=S=>{r(S.length>0?S:[""])},N=S=>{i(S)};return e.jsx(V,{children:e.jsx(F,{className:"p-4 md:p-6",children:e.jsxs("form",{onSubmit:d,className:"space-y-6",children:[e.jsx(je,{formData:s,onRoomChange:i,onFormDataChange:u}),e.jsx(Ce,{assets:o,onAssetChange:l,onAddAsset:m,onRemoveAsset:p,onAssetCodesDetected:v,onRoomDetected:N}),e.jsx(ke,{formData:s,onFormDataChange:u}),e.jsx(ye,{formData:s,setFormData:a,disabledBeforeDate:j}),e.jsx(Ne,{isRestrictedTime:t,isFormValid:x,isLoading:h,user:n,onClear:c,onSubmit:d,onTestEmail:()=>f((n==null?void 0:n.username)||"")})]})})})},Ee=()=>{const[t,n]=b.useState(!1);return b.useEffect(()=>{const s=()=>{const o=new Date,r=o.getHours(),i=o.getMinutes(),l=r*60+i,m=l>=465&&l<=485||l>=765&&l<=785;n(m)};s();const a=setInterval(s,6e4);return()=>clearInterval(a)},[]),{isRestrictedTime:t}},Ge=()=>{const{isRestrictedTime:t}=Ee();return e.jsx(U,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx(ge,{}),t&&e.jsxs(Q,{variant:"destructive",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx(Y,{children:"C·∫£nh b√°o!"}),e.jsx(Z,{children:"Hi·ªán t·∫°i ƒëang trong khung gi·ªù c·∫•m (7:45-8:05 ho·∫∑c 12:45-13:05). Vui l√≤ng nh·∫Øn Zalo thay v√¨ d√πng h·ªá th·ªëng."})]}),e.jsx(Me,{isRestrictedTime:t})]})})};export{Ge as default};
