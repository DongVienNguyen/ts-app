import{r as i,j as e,B as p,L as f,s as g}from"./index-DpfqfBid.js";import{A as b,a as y,I as v}from"./input-BQM1MWAl.js";import{L as j}from"./label-DTj3kehB.js";import{P as N,C as k,a as w,b as C,c as L}from"./index-1NCKpGgW.js";import{M as S}from"./mail-Bh76pHpI.js";import{A as E}from"./arrow-left-Nk-Mvx4R.js";const B=()=>{const[r,c]=i.useState(""),[n,t]=i.useState({type:"",text:""}),[o,s]=i.useState(!1),h=l=>{const a=l.target.value.toLowerCase().trim();c(a)},d=async l=>{l.preventDefault(),s(!0),t({type:"",text:""});try{if(!r.endsWith(".hvu@vietcombank.com.vn")){t({type:"error",text:"Email pháº£i cÃ³ Ä‘á»‹nh dáº¡ng: tÃªn.hvu@vietcombank.com.vn"}),s(!1);return}const a=r.replace(".hvu@vietcombank.com.vn",""),{data:m,error:u}=await g.from("staff").select("username, account_status").ilike("username",a).maybeSingle();if(u){t({type:"error",text:"ÄÃ£ xáº£y ra lá»—i trong quÃ¡ trÃ¬nh kiá»ƒm tra thÃ´ng tin"}),s(!1);return}if(!m){t({type:"error",text:"KhÃ´ng tÃ¬m tháº¥y nhÃ¢n viÃªn vá»›i email nÃ y"}),s(!1);return}if(m.account_status==="locked"){t({type:"error",text:"TÃ i khoáº£n nÃ y Ä‘Ã£ bá»‹ khÃ³a vÃ  khÃ´ng thá»ƒ Ä‘áº·t láº¡i máº­t kháº©u. Vui lÃ²ng liÃªn há»‡ Admin."}),s(!1);return}const x=Math.floor(1e5+Math.random()*9e5).toString();console.log("Sending email to:",r),console.log("New password:",x),t({type:"success",text:"Máº­t kháº©u má»›i Ä‘Ã£ Ä‘Æ°á»£c gá»­i Ä‘áº¿n email cá»§a báº¡n. Vui lÃ²ng kiá»ƒm tra há»™p thÆ°."}),c("")}catch(a){console.error("ğŸ’¥ Reset password error:",a),t({type:"error",text:"ÄÃ£ xáº£y ra lá»—i trong quÃ¡ trÃ¬nh reset máº­t kháº©u"})}finally{s(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mb-4",children:e.jsx(N,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Äáº·t láº¡i máº­t kháº©u"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Nháº­p email cá»§a báº¡n Ä‘á»ƒ nháº­n máº­t kháº©u má»›i."})]}),e.jsxs(k,{className:"shadow-lg border-0",children:[e.jsx(w,{children:e.jsx(C,{className:"text-xl text-center",children:"Äáº·t láº¡i máº­t kháº©u"})}),e.jsxs(L,{className:"space-y-6",children:[n.text&&e.jsx(b,{variant:n.type==="error"?"destructive":"default",children:e.jsx(y,{children:n.text})}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"email",children:"Äá»‹a chá»‰ Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(v,{id:"email",type:"email",placeholder:"Nháº­p Ä‘áº§y Ä‘á»§ email: abc.bcd@abc.com.vn",value:r,onChange:h,className:"pl-10",required:!0})]})]}),e.jsx(p,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700",disabled:o,children:o?"Äang gá»­i...":"Reset Máº­t kháº©u"})]}),e.jsx("div",{className:"text-center",children:e.jsxs(f,{to:"/login",className:"inline-flex items-center text-sm text-blue-600 hover:text-blue-800 hover:underline",children:[e.jsx(E,{className:"w-4 h-4 mr-1"}),"Quay láº¡i trang ÄÄƒng nháº­p"]})})]})]})]})})};export{B as default};
